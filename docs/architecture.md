# Архитектура системы Red Team AI-агента

## Общее описание

Система представляет собой набор взаимосвязанных сервисов для автоматизированного тестирования веб-сайтов на проникновение с использованием Metasploit Framework и локальной LLM модели. Система работает по стандартным этапам пентеста, генерирует команды для Metasploit, анализирует результаты и отображает весь процесс в реальном времени через веб-интерфейс.

## Компоненты системы

### 1. Бэкенд (Flask)

Бэкенд система отвечает за:
- Управление процессом пентестинга
- Взаимодействие с LLM моделью
- Выполнение команд Metasploit
- Анализ результатов
- Предоставление API для фронтенда

**Основные модули бэкенда:**
- `app.py` - основной файл приложения Flask
- `metasploit_controller.py` - модуль для взаимодействия с Metasploit через msfrpcd
- `llm_controller.py` - модуль для взаимодействия с локальной LLM моделью
- `pentest_orchestrator.py` - модуль для управления процессом пентестинга
- `database.py` - модуль для хранения результатов и состояния пентеста

### 2. Фронтенд (React)

Фронтенд система отвечает за:
- Отображение процесса пентестинга в реальном времени
- Визуализацию результатов
- Управление процессом пентестинга (запуск, остановка, пауза)
- Отображение логов и отчетов

**Основные компоненты фронтенда:**
- Панель управления пентестом
- Терминал с выводом команд и результатов
- Визуализация процесса пентестинга по этапам
- Отображение найденных уязвимостей
- Генерация отчетов

### 3. LLM Агент

LLM агент отвечает за:
- Генерацию точных команд Metasploit на основе контекста
- Анализ результатов выполнения команд
- Принятие решений о следующих шагах
- Формирование отчетов

**Компоненты LLM агента:**
- Промпт-инженерия для генерации команд
- Система обработки контекста
- Механизм анализа результатов
- Логика принятия решений

### 4. Metasploit Framework

Metasploit используется как инструмент взаимодействия с тестовой средой:
- Запуск через msfrpcd (Metasploit RPC daemon)
- Выполнение команд через API
- Получение результатов выполнения команд

## Взаимодействие компонентов

1. **Пользователь** инициирует пентест через веб-интерфейс, указывая цель и параметры
2. **Бэкенд** запускает процесс пентестинга и инициализирует LLM агента
3. **LLM агент** генерирует команду для Metasploit на основе текущего этапа пентеста
4. **Бэкенд** выполняет команду через Metasploit API
5. **Metasploit** выполняет команду и возвращает результат
6. **LLM агент** анализирует результат и принимает решение о следующем шаге
7. **Бэкенд** отправляет обновления на фронтенд через WebSocket
8. **Фронтенд** отображает процесс в реальном времени
9. Процесс повторяется до завершения всех этапов пентеста

## Технические детали

### Коммуникация между сервисами
- REST API для управления процессом
- WebSocket для передачи данных в реальном времени
- RPC для взаимодействия с Metasploit

### Безопасность
- Аутентификация для доступа к веб-интерфейсу
- Изоляция тестовой среды
- Логирование всех действий

### Масштабируемость
- Возможность запуска нескольких пентестов одновременно
- Очередь задач для распределения нагрузки
- Кэширование результатов для оптимизации производительности
